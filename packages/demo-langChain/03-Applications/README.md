## ReAct & Function Agent 差别

### 简述
ReAct Agent 适合：
- 需要看到详细推理过程的场景
- 需要零样本学习的场景（不需要事先学习类似任务）
- 解决需要多步骤推理的复杂问题
- 适合用于教育或解释性场景，可以展示 AI 是如何一步步解决问题的
- 适用于任何支持基本文本生成的 LLM

OpenAI Functions Agent 适合：
- 面向用户的对话场景，尤其是需要保持对话历史的场景
- 需要更自然、流畅对话体验的应用
- 工具调用需要结构化参数的场景
- 复杂的旅行规划、电商客服等需要多轮交互的应用
- 需要精确工具调用的场景（参数解析更精确）
- 仅适用于支持函数调用 API 的模型（如 OpenAI 的 gpt-3.5-turbo 和 gpt-4）

### 场景
场景 1: 使用 Functions Agent 而不是 ReAct Agent
假设你正在开发一个旅游助手应用，需要处理类似"帮我规划明天去北京的一日游行程"这样的多步骤请求:
Functions Agent 优势:
- 可以直接解析"北京"和"一日游"为正确的参数格式
- 能够自然地维护对话上下文，记住用户提到的城市和喜好
- 回答会更流畅、自然，不会向用户暴露思考过程
如果使用 ReAct Agent:
- 用户会看到"Thought: 我需要先获取北京的旅游景点..."这样的思考过程
- 在多轮对话中无法自然地引用之前提到的信息
- 工具调用可能不够精确，参数解析准确率较低

场景 2: 使用 ReAct Agent 而不是 Functions Agent
假设你在开发一个数学解题器，需要将复杂问题分解为多个步骤:
ReAct Agent 优势:
- 可以显示详细的解题步骤: "Thought: 我需要先计算方程的一阶导数..."
- 适用于任何 LLM 模型，不限于支持函数调用的模型
- 问题分解过程清晰可见，便于调试和改进

如果使用 Functions Agent:
- 无法清楚看到问题解决的中间步骤
- 如果你的模型不支持函数调用 API，就完全无法使用
- 难以理解 AI 是如何推导出答案的，尤其在复杂问题上

简而言之:
- 如果你在开发面向用户的对话助手，需要自然的对话体验，选择 Functions Agent
- 如果你在开发需要展示详细推理过程的工具，或使用不支持函数调用的模型，选择 ReAct Agent

### 示例
"现在几点了？并计算 15 × 7 的结果"

**ReAct Agent 处理流程：**

- 输入到 LLM 的提示
```
你是一个能够使用工具解决问题的智能助手。
请根据用户的问题，选择合适的工具来解决。

Tool 1: "get_current_time" - 获取当前时间，可以指定时间格式，如 '%Y-%m-%d %H:%M:%S'
Tool 2: "calculator" - 对于表达式求值，如'2 + 2'或'15 * 7'等数学表达式

使用以下格式:
Thought: 你对问题的思考
Action: 工具名称
Action Input: 工具的输入参数
Observation: 工具的输出结果(这会由系统提供)
... (思考和行动可以重复多次)
Thought: 我现在知道最终答案了
Final Answer: 最终对用户问题的回答

用户问题: 现在几点了？并计算 15 × 7 的结果
```
- LLM 输出：
```
Thought: 我需要完成两个任务：1) 获取当前时间，2) 计算 15×7 的结果。我会先获取当前时间。
Action: get_current_time
Action Input: "%H:%M:%S"
```
- 系统执行工具后添加：
```
Observation: "14:30:25"
```
- LLM 继续输出：
```
Thought: 现在我需要计算 15×7 的结果。
Action: calculator
Action Input: 15 * 7
```
- 系统执行工具后添加：
```
Observation: "105"
```
- LLM 最终输出：
```
Thought: 我现在有了所有需要的信息。
Final Answer: 现在是 14:30:25，15×7 的结果是 105。
```

**OpenAI Functions Agent 处理流程：**
- 输入到 LLM 的提示：
```
你是一个助手，可以帮助用户回答问题。
你可以获取当前时间和进行数学计算。
始终使用提供的工具回答问题，不要编造答案。

用户: 现在几点了？并计算 15 × 7 的结果
```
- LLM 输出：
```json
// 在 OpenAI 模型中，会直接以 JSON 格式输出函数调用请求，而不是文本思考
{
  "function": "get_current_time",
  "parameters": {
    "format_string": "%H:%M:%S"
  }
}
```
- 系统执行工具后，将结果传回 LLM：
```
工具返回: "14:30:25"
```
- LLM 第二次输出：
```
{
  "function": "calculator",
  "parameters": {
    "expression": "15 * 7"
  }
}
```
- 系统执行工具后，将结果传回 LLM
```
工具返回: "105"
```
- LLM 最终输出：
```
现在时间是 14:30:25，15×7 的计算结果是 105。
```